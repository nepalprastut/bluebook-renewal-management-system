<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Renewal History</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<nav>
  <h2>Bluebook Renewal</h2>
  <a href="index.html"><i class="fas fa-car"></i> Vehicles</a>
  <a href="renewals.html" class="active"><i class="fas fa-history"></i> Renewal History</a>
</nav>

<main>
  <header>
    <h1>Bluebook Renewal History</h1>
  </header>

  <div class="card">
    <table>
      <thead>
        <tr>
          <th>Plate No</th>
          <th>Renewal Date</th>
          <th>Valid Period</th>
          <th>Amount</th>
          <th>Payment Date</th>
        </tr>
      </thead>
      <tbody id="renewalTable"></tbody>
    </table>
  </div>
</main>

<script>
function formatDate(d) {
  if (!d) return "-";
  return new Date(d).toISOString().split("T")[0];
}

async function loadRenewals() {
  const res = await fetch("/api/renewals");
  const data = await res.json();

  const table = document.getElementById("renewalTable");
  table.innerHTML = "";

  data.forEach(r => {
    table.innerHTML += `
      <tr>
        <td><strong>${r.plate_no}</strong></td>
        <td>${formatDate(r.renewal_date)}</td>
        <td>${formatDate(r.valid_from)} â†’ ${formatDate(r.valid_to)}</td>
        <td>${r.amount ?? "-"}</td>
        <td>${formatDate(r.payment_date)}</td>
      </tr>
    `;
  });
}

loadRenewals();
</script>

</body>
</html>