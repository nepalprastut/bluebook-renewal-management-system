<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bluebook Renewal System - Login</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body class="login-body">

  <div class="login-card">
    <h1>Bluebook Renewal System</h1>
    <p class="subtitle">Secure Vehicle Record Management</p>

    <input id="username" placeholder="Username">
    <input id="password" type="password" placeholder="Password">

    <button onclick="login()">Login</button>
    
    <p class="auth-link">New owner? <a href="register.html">Register here</a></p>
    
    <p id="msg"></p>
  </div>

<script>
async function login() {
  const res = await fetch("/api/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      username: username.value,
      password: password.value
    })
  });

  const data = await res.json();

  if (data.user_id && data.role) {
    sessionStorage.setItem("user_id", data.user_id);
    sessionStorage.setItem("role", data.role);

    if (data.role === "ADMIN") {
      window.location.href = "admin.html";
    } else if (data.role === "OWNER") {
      window.location.href = "index.html";
    }
  } else {
    document.getElementById("msg").innerText = data.error;
    document.getElementById("msg").style.color = "red";
  }
}
</script>

</body>
</html>